// Code generated by girgen. DO NOT EDIT.

package pango

import (
	"runtime"
	"unsafe"

	externglib "github.com/gotk3/gotk3/glib"
)

// #cgo pkg-config:
// #cgo CFLAGS: -Wno-deprecated-declarations
// #include <glib-object.h>
// #include <pango/pango.h>
import "C"

func init() {
	externglib.RegisterGValueMarshalers([]externglib.TypeMarshaler{
		{T: externglib.Type(C.pango_script_iter_get_type()), F: marshalScriptIter},
	})
}

// ScriptIter: a `PangoScriptIter` is used to iterate through a string and
// identify ranges in different scripts.
type ScriptIter struct {
	native C.PangoScriptIter
}

// WrapScriptIter wraps the C unsafe.Pointer to be the right type. It is
// primarily used internally.
func WrapScriptIter(ptr unsafe.Pointer) *ScriptIter {
	if ptr == nil {
		return nil
	}

	return (*ScriptIter)(ptr)
}

func marshalScriptIter(p uintptr) (interface{}, error) {
	b := C.g_value_get_boxed((*C.GValue)(unsafe.Pointer(p)))
	return WrapScriptIter(unsafe.Pointer(b)), nil
}

// NewScriptIter constructs a struct ScriptIter.
func NewScriptIter(text string, length int) *ScriptIter {
	var _arg1 *C.char
	var _arg2 C.int

	_arg1 = (*C.char)(C.CString(text))
	defer C.free(unsafe.Pointer(_arg1))
	_arg2 = C.int(length)

	var _cret *C.PangoScriptIter

	cret = C.pango_script_iter_new(_arg1, _arg2)

	var _scriptIter *ScriptIter

	_scriptIter = WrapScriptIter(unsafe.Pointer(_cret))
	runtime.SetFinalizer(_scriptIter, func(v *ScriptIter) {
		C.free(unsafe.Pointer(v.Native()))
	})

	return _scriptIter
}

// Native returns the underlying C source pointer.
func (s *ScriptIter) Native() unsafe.Pointer {
	return unsafe.Pointer(&s.native)
}

// Free frees a ScriptIter created with pango_script_iter_new().
func (i *ScriptIter) Free() {
	var _arg0 *C.PangoScriptIter

	_arg0 = (*C.PangoScriptIter)(unsafe.Pointer(i.Native()))

	C.pango_script_iter_free(_arg0)
}

// Range gets information about the range to which @iter currently points. The
// range is the set of locations p where *start <= p < *end. (That is, it
// doesn't include the character stored at *end)
//
// Note that while the type of the @script argument is declared as PangoScript,
// as of Pango 1.18, this function simply returns GUnicodeScript values. Callers
// must be prepared to handle unknown values.
func (i *ScriptIter) Range() (start string, end string, script Script) {
	var _arg0 *C.PangoScriptIter

	_arg0 = (*C.PangoScriptIter)(unsafe.Pointer(i.Native()))

	var _arg1 *C.char
	var _arg2 *C.char
	var _arg3 C.PangoScript

	C.pango_script_iter_get_range(_arg0, &_arg1, &_arg2, &_arg3)

	var _start string
	var _end string
	var _script Script

	_start = C.GoString(_arg1)
	defer C.free(unsafe.Pointer(_arg1))
	_end = C.GoString(_arg2)
	defer C.free(unsafe.Pointer(_arg2))
	_script = Script(_arg3)

	return _start, _end, _script
}

// Next advances a ScriptIter to the next range. If @iter is already at the end,
// it is left unchanged and false is returned.
func (i *ScriptIter) Next() bool {
	var _arg0 *C.PangoScriptIter

	_arg0 = (*C.PangoScriptIter)(unsafe.Pointer(i.Native()))

	var _cret C.gboolean

	cret = C.pango_script_iter_next(_arg0)

	var _ok bool

	if _cret {
		_ok = true
	}

	return _ok
}
